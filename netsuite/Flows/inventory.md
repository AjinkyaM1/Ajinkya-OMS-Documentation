---
description: >-
  Automated sync of inventory data from NetSuite to HotWax Commerce to ensure
  accurate inventory counts.
---

# Inventory

NetSuite serves as the central system of record for tracking product inventories across various retail locations. Inventory transactions in Netsuite, encompassing the creation and reception of purchase orders (POs) in warehouses, as well as the fulfillment of online orders from these warehouses, are vital components for maintaining real-time and precise inventory records.

However, while HotWax Commerce receives frequent updates regarding online orders fulfilled from the warehouse using NetSuite, it does not receive regular updates on new inventory arrivals in the warehouses in response to purchase orders. This discrepancy causes HotWax Commerce to fall out of synchronization with inventory data of NetSuite.

To ensure that HotWax Commerce remains continually synchronized with the latest inventory information, the daily synchronization of inventory data is paramount. This synchronization process revolves around the extraction of inventory data from NetSuite and the subsequent update of HotWax Commerce's inventory records. This process is typically scheduled during off-peak hours, often taking place in the late hours of the night or in the early morning.

### Key Objectives

* Automate the daily synchronization of inventory data from Netsuite to HotWax Commerce.
* Ensure that HotWax Commerce reflects the most recent inventory numbers, as recorded in NetSuite.

<figure><img src="../.gitbook/assets/inventory sync.png" alt=""><figcaption><p>Inventory Sync from NetSuite to HotWax Commerce</p></figcaption></figure>

**Actions**

1. A Scheduled Script, equipped with the capability to utilize the Search Task from the N/task module, is executed. The objective of this script is to retrieve inventory records for all products stored within NetSuite. This is achieved through the execution of a saved search, specifically tailored for this purpose. Once the search is complete, the script generates a CSV file containing the inventory data and puts it within NetSuite's File Cabinet.

{% hint style="info" %}
The Search Task function, utilized here, can generate and store a file solely within NetSuite's File Cabinet. It lacks the capability to place the file in an SFTP location. As a result, another scheduled script is necessary to accomplish this task.
{% endhint %}

**SuiteScript**

```
HC_generateCSV_InventoryItems
```

2. A secondary Scheduled Script is triggered, which is responsible for retrieving the CSV file generated by the previous script from NetSuite's File Cabinet and subsequently relocating it to the designated SFTP location. An essential aspect to consider is that a 15-minute time gap is introduced between these two scripts. This delay is introduced to allow the asynchronous task, internally generated by NetSuite when executing the Search Task function of the N/Task module, to complete. Without this interval, the second script might run before the asynchronous task finishes, leading to an empty folder in NetSuite File Cabinet. This script not only transfers the files but also archives them from the NetSuite File Cabinet.

**SuiteScript**

```
HC_uploadCSV_InventoryItems
```

**SFTP Locations**

```
/home/{sftp.user}/netsuite/inventoryitem/csv
```

3. The final step in the workflow involves a scheduled job within HotWax Commerce OMS. This job is responsible for reading the Inventory Sync CSV files from the SFTP location. It utilizes this data to reset the inventory numbers for products within the HotWax Commerce system.

**Job in HotWax Commerce**

```
Import inventory
FTP Config: RESET_INVENTORY
```

### Why Search Task

In this particular use case, we have employed the Search Task function of the N/Task module for exporting inventory data from NetSuite. This approach is distinct from other scenarios where we utilized Map Reduce scripts and regular saved searches using the N/Search module. Our decision to implement Search Task for this specific purpose is based on our practical experience with various methods of exporting data from NetSuite, which revealed compelling reasons for this choice:

#### Handling Extensive Inventory Records

Initially, we attempted to synchronize inventory data from NetSuite to HotWax Commerce using Suite Script with a standard saved search through the N/Search module. However, this approach proved to be impractical when dealing with a high volume of inventory records. The script execution time exceeded the maximum threshold of one hour for Scheduled Scripts. NetSuite's documentation reinforced that SuiteScript is best suited for handling smaller data sets, making it evident that an alternative approach was required.

#### Efficiency of Map Reduce Scripts

Subsequently, we transitioned to Map Reduce scripts to manage the synchronization of inventory between NetSuite and HotWax Commerce. Map Reduce scripts are designed to handle large datasets efficiently and demonstrated significantly improved performance compared to Scheduled Scripts. Notably, even if the script ~~execution~~ extends beyond one hour, Map Reduce jobs are designed to manage NetSuite resources effectively, allowing them to complete the task. Based on our experience, processing a million inventory records required approximately two hours.

#### Harnessing SearchTask Function

To optimize the process and achieve rapid synchronization, we adopted SuiteScript in combination with the Search Task function from the N/Task module. The results were remarkable, with the execution time reduced to a mere 10-15 seconds for a million inventory records. The search was executed swiftly, the CSV file was generated, and it was deposited in NetSuite's File Cabinet within a matter of seconds. This extraordinary speed and efficiency led us to the conclusion that the Search Task of the N/Task module was the ideal choice for synchronizing inventory records from NetSuite to HotWax Commerce.

## Inventory Transfers

Retailers we work with set up two types of warehouse facilities in NetSuite: one for eCommerce and the other for wholesale. The eCommerce warehouse is responsible for fulfilling online orders, while the wholesale warehouse is mainly used for B2B operations, transfer orders and inventory transfers.

{% hint style="info" %}
Transfer orders are created for relocating inventory between different locations: from warehouse to store, store to warehouse, or between store transfers. These transactions involve the fulfillment and receiving of transfer orders. While in case of inventory transfers between warehouses, fulfillment and receiving isn't involved, instead, inventory is directly moved, and the impact on inventory levels is immediately recorded.
{% endhint %}

Learn more about [transfer orders](https://docs.hotwax.co/integration-resources/v/netsuite-integration/supported-integrations/transfer-order)

When the eCommerce warehouse's inventory dips below expected levels, retailers perform inventory transfers from the wholesale warehouse to quickly replenish stock in the eCommerce warehouse.

The effectiveness of this process relies on timely synchronization. If inventory transfer receipts at the eCommerce warehouse are synchronized with HotWax Commerce during the daily inventory sync with NetSuite, there's a risk of ending up with outdated inventory levels. As discussed, this daily sync is scheduled during off-peak hours, such as late at night or early in the morning. As a result, this timing could potentially result in missed sales opportunities. Sometimes retailers may also transfer inventory from their eCommerce warehouse to their wholesale warehouse, in this case as well it is necessary to update inventory levels in HotWax Commerce to avoid overpromising online.

Therefore, whenever retailers perform inventory transfers to or from eCommerce warehouse, HotWax Commerce timely updates the inventory counts and maintains the most real-time synchronization with NetSuite inventory levels.

<figure><img src="../.gitbook/assets/inventory transfer.png" alt=""><figcaption><p>Inventory Transfer Sync from NetSuite to HotWax Commerce</p></figcaption></figure>

**Actions**

1. A Map Reduce Script in NetSuite runs every 15 minutes and generates a inventory transfer CSV file. This file contains product details, inventory delta reflecting increase or decrease in a product's inventory at the eCommerce warehouse and places this file at the designated SFTP location.

**SuiteScript**

Export inventory transfer records

```
HC_MR_ExportedInventoryTransferCSV.js
```

**SFTP Locations**

```
/home/{sftp-username}/netsuite/inventorytransfer/import
```

2. A scheduled job in HotWax Commerce reads the CSV file from the SFTP location and adjusts the inventory records in HotWax Commerce. When inventory is transferred to the eCommerce warehouse, the scheduled job increases the inventory count for the respective product. Conversely, when inventory is transferred from the eCommerce warehouse, the job reduces the inventory count accordingly.

**Job in HotWax Commerce**

Import inventory transfer records

```
IMP_INV_TRANS
Import Inventory Transfer
```
